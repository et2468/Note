# JPQL 중급 - Named 쿼리

**참고자료**

해당 내용은 다음 강의를 참고하여 정리하였습니다. 

![](https://cdn.inflearn.com/public/courses/324119/course_cover/07c45106-3cfa-4dd6-93ed-a6449591831c/%E1%84%80%E1%85%B3%E1%84%85%E1%85%AE%E1%86%B8%205%20%E1%84%87%E1%85%A9%E1%86%A8%E1%84%89%E1%85%A1%204.png)

[실전! 스프링 부트와 JPA 활용1 - 웹 애플리케이션 개발](https://www.inflearn.com/course/%EC%8A%A4%ED%94%84%EB%A7%81%EB%B6%80%ED%8A%B8-JPA-%ED%99%9C%EC%9A%A9-1/dashboard)



### Named 쿼리란?

- 미리 정의해서 이름을 부여해두고 사용하는 JPQL
- 정적 쿼리에만 사용가능하다.
- 애플리케이션 로딩 시점에 초기화 후 재사용
- **애플리케이션 로딩 시점에 쿼리를 검증**
  - **이로써 JPQL문법 오류를 빠르게 파악할 수 있다. (중요)**



### Named 쿼리, 애노테이션

```java
@Entity
@NamedQuery(
    name = "Member.findByUsername",
    query="select m from Member m where m.username = :username")
public class Member {
    // ...
}

List<Member> resultList = 
    em.createNamedQuery("Member.findByUsername", Member.class)
    .setParameter("username", "회원1")
    .getResultList();
```



### Named 쿼리, XML

[META-INF/persistence.xml]

```xml
<persistence-unit name="jpabook" >
 <mapping-file>META-INF/ormMember.xml</mapping-file>
```

[META-INF/ormMember.xml]

```xml
<?xml version="1.0" encoding="UTF-8"?>
<entity-mappings xmlns="http://xmlns.jcp.org/xml/ns/persistence/orm" version="2.1">
    <named-query name="Member.findByUsername">
        <query><![CDATA[
 select m
 from Member m
 where m.username = :username
 ]]></query>
    </named-query>
    <named-query name="Member.count">
        <query>select count(m) from Member m</query>
    </named-query>
</entity-mappings>
```



XML이 항상 우선권을 가지며, 애플리케이션 운영 환경에 따라 다른 XML을 배포할 수 있다.



### SpringDataJpa

SpringDataJpa를 활용하면 메서드 바로 위에 @Query로 Named쿼리를 만들 수 있다.

```java
public interface UserRepository extends JpaRepository<User, Long> {

  @Query("select u from User u where u.emailAddress = ?1")
  User findByEmailAddress(String emailAddress);
}
```

