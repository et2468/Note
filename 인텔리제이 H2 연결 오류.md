# 인텔리제이 H2 연결 오류

### 오류 문구

```
[2023-10-12 10:23:41] [90020][90020] Database may be already in use: null. Possible solutions: close all other connection(s); use the server mode [90020-210]
[2023-10-12 10:23:41] The file is locked: C:/Users/asus/jpashop.mv.db [2.1.210/7]
```

이미 연결되어 있다고 한다. 다른 애플리케이션에서 접속중일 수 있다고 하는데,

브라우저에서 연결해서 그런건지 다른 이유인지 정확하겐 모르겠다.





### 해결

인프런에서 나와 같은 오류메시지를 받은 사람이 있었다.

답변으로는 JDBC URL을 `jdbc:h2:tcp://localhost/~/jpashop`로 바꾸어 주라고 한다.

하니까 된다.



그래서 H2 DB 연결 방법 종류를 알아보았다.



### H2 데이터베이스 연결 방식들

1. **내장 모드 (Embedded Mode)**:

- H2 데이터베이스를 독립 실행형 애플리케이션 내에서 사용하는 방식

- 데이터베이스는 애플리케이션과 함께 실행되며 애플리케이션에 포함된 JAR 파일 안에 데이터베이스가 포함된다.

- 내장 모드의 연결 방법:

  - JDBC 드라이버를 사용하여 애플리케이션 내에서 데이터베이스에 직접 연결

  - 데이터베이스 파일은 애플리케이션 실행 디렉토리 또는 지정한 경로에 저장

  - 이 모드는 개발 및 테스트 환경에서 주로 사용



2. **서버 모드 (Server Mode):**

- 서버 모드에서 H2 데이터베이스는 독립 실행형 데이터베이스 서버로 실행됩니다. 이 데이터베이스 서버는 여러 클라이언트 애플리케이션이 동시에 연결할 수 있습니다.
- 서버 모드의 연결 방법:
  - 데이터베이스 서버를 시작하고, 클라이언트 애플리케이션은 데이터베이스 서버에 연결합니다.
  - JDBC 드라이버를 사용하여 데이터베이스 서버에 연결합니다.
  - 데이터베이스 파일은 서버 모드를 실행하는 컴퓨터에 저장됩니다.

3. **웹 콘솔 (Web Console)을 통한 연결:**

- H2 데이터베이스는 웹 콘솔을 제공하며, 웹 브라우저를 통해 데이터베이스에 연결하고 관리할 수 있습니다.
- 웹 콘솔을 통한 연결 방법:
  - 웹 브라우저를 열고 웹 콘솔 URL에 접속합니다. 기본 URL은 `http://localhost:8082`입니다.
  - 웹 콘솔을 사용하여 SQL 쿼리를 실행하고 데이터베이스를 시각적으로 관리합니다.

4. **파일 모드 (File Mode) 및 메모리 모드 (Memory Mode):**

- H2 데이터베이스는 파일 모드와 메모리 모드로 사용할 수 있습니다.
- 파일 모드는 데이터베이스 파일을 디스크에 저장하는 모드이며, 메모리 모드는 데이터베이스를 메모리에 저장하는 모드입니다.
- 연결 방법은 내장 모드 및 서버 모드와 동일하지만 데이터베이스의 저장 위치가 다릅니다.



Chat-GPT에 물어보니까 3. 웹콘솔을 통한 연결은 여러 클라이언트가 접속할 수 없다고 한다.

 `jdbc:h2:tcp://localhost/~/jpashop`은 2. 서버모드로 접속하는 방식으로 여러 클라이언트가 접속가능해진것 같다.







